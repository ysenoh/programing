[CodeIQ 公開コード一覧](../README.md)

# 問題
南北方向に一直線の道路が x 本、東西方向に一直線の道路が y 本あり、碁盤の目のように区分けされている街がある。  
この道路に沿って、左上から右下に向けて移動するとき、東と南だけに向かって最短距離で移動する。  
ただ、途中の交差点には、工事されていて通行できないところがある。  
最短距離で到達できる道順が n 通りのとき、工事されている場所として考えられる交差点が何通りあるか求めなさい。  
ただし、最短距離で到達できない（手前に工事している交差点がある）交差点は、工事されているかどうか確認できないため、工事されている場所として考えないものとする。  

+ [今週のお題:工事中の交差点はどこ？(受付終了)](https://codeiq.jp/q/3469)
+ [「今週のアルゴリズム：工事中の交差点はどこ？」正解者発表](https://codeiq.jp/magazine/2017/11/56135/)

# 方針

## 案1
左上をS、右下をGとする。  
交差点 AとBが工事中の場合、ルート数は、すべてのルート数 - Aを通過するルート数 - Bを通過するルート数 + AとBを通過するルート数である。  
手前で工事しているかどうかは、その交差点を計算に入れた時に、ルート数が減少するかどうかで判定できる。  
これにより、条件を満たす組み合わせを求める。

この方法では、条件を満たすパターンを数え上げることになるので、全探索と変わらない。  
故に断念。

## 案2
縦の道で分割して、その各交差点までのルート数を求め、これらの値と何列目かという数値をまとめてベクトルとし、このベクトルを引数にもつ関数を再帰的に定義して求める。  
漸化式として解くやり方。  

この方法では、同じベクトルになるパターンが非常に少なそうで、キャッシュしても高速化は見込めず、メモリの消費も多い。  
故に断念。


## 案3
先にすべてのルートを、通過する交差点のビットイメージで数値に変換する。  
指定されたルート数のパターンのみによるbit和のパターンを求める。  
つまり、ルート数から適合する工事中箇所のパターンを求める。  

手前で工事しているわけではないが、死に道になって使われない交差点がある場合に対応できないので、不可。  



## 案4
全探索する。  
ある交差点までのルート数は、上の交差点と左の交差点までのルート数の和であり、工事中の交差点はその数値に0を設定することで表現することが出来る。  
交差点までのルート数が0の場合は、手前で工事されているものとして、工事中としての探索を行わない。  
また、ある交差点を工事中としなかったのに、それより先のすべてのパターンにおいてルート数が指定されたルート数より小さくなる場合は、ここを工事中にして成立することはありえないので、それも探索しない。  

最終的にはこの方法で実装した。  
交差点の個数に対して、指数的に時間がかかるので、枝刈りが重要。  

# コード
[solve.py](solve.py)







